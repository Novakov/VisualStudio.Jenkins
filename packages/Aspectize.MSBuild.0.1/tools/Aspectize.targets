<?xml version="1.0" encoding="utf-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="Aspectize.tasks" />

  <PropertyGroup>
    <InjectAspects Condition="$(InjectAspects)==''">true</InjectAspects>
  </PropertyGroup>
  
  <PropertyGroup Condition="$(InjectAspects)=='true'">
    <TargetsTriggeredByCompilation>
      $(TargetsTriggeredByCompilation);
      InjectAspects
    </TargetsTriggeredByCompilation>
  </PropertyGroup>

  <Target Name="InjectAspects">    
    <Message Text="Debug symbols: @(_DebugSymbolsIntermediatePath)" />    
    <InjectAspects AssemblyPath="@(IntermediateAssembly->'%(FullPath)')" References="@(ReferencePath)" DebugSymbols="@(_DebugSymbolsIntermediatePath)" GenerateIntermediateResults="true"/>
  </Target>
</Project>